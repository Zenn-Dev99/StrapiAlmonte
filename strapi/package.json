{
  "name": "bd-2025",
  "version": "0.1.0",
  "private": true,
  "description": "A Strapi application",
  "scripts": {
    "build": "NODE_OPTIONS='--max-old-space-size=8192' strapi build",
    "console": "strapi console",
    "deploy": "strapi deploy",
    "dev": "strapi develop",
    "develop": "NODE_OPTIONS='--max-old-space-size=8192' strapi develop",
    "seed:example": "node ../scripts/seed.js",
    "seed:demo:colegio": "node ../scripts/create-demo-colegio.js",
    "seed:demo:academico": "node ../scripts/seed-demo-academico.js",
    "seed:demo:listas-utiles": "node ../scripts/seed-demo-listas-utiles.js",
    "fix:logos": "node ../scripts/fix-colegio-logos.js",
    "test": "vitest run",
    "test:watch": "vitest",
    "test:ui": "vitest --ui",
    "test:coverage": "vitest run --coverage",
    "test:db": "node -r dotenv/config ../scripts/test-database-connection.mjs",
    "test:db:connection": "node -r dotenv/config ../scripts/test-database-connection.mjs",
    "analyze:fields": "node ../scripts/analyze-field-usage.mjs",
    "audit:fields": "node ../scripts/auditar_campos_v1.js",
    "maintenance:run": "node -r dotenv/config ../scripts/run-maintenance-tasks.cjs",
    "maintenance:content-manager": "node -r dotenv/config ../scripts/run-maintenance-tasks.cjs content-manager",
    "maintenance:migrate-estados": "node -r dotenv/config ../scripts/run-maintenance-tasks.cjs migrate-estados",
    "maintenance:backfill-telefonos": "node -r dotenv/config ../scripts/run-maintenance-tasks.cjs backfill-telefonos",
    "maintenance:backfill-curso-titulos": "node -r dotenv/config ../scripts/run-maintenance-tasks.cjs backfill-curso-titulos",
    "maintenance:backfill-curso-asignatura": "node -r dotenv/config ../scripts/run-maintenance-tasks.cjs backfill-curso-asignatura",
    "maintenance:email-templates": "node -r dotenv/config ../scripts/run-maintenance-tasks.cjs email-templates",
    "start": "strapi start",
    "strapi": "strapi",
    "upgrade": "npx @strapi/upgrade latest",
    "upgrade:dry": "npx @strapi/upgrade latest --dry",
    "import:data": "node -r dotenv/config ../scripts/import-data.mjs",
    "import:colegios": "node -r dotenv/config ../scripts/import-colegios.mjs ../data/colegios.csv",
    "import:colegios:v2": "node -r dotenv/config ../scripts/import-colegios-v2.mjs ../data/csv/import_contactos/colegios_importar.csv",
    "import:colegios:v2:dry": "bash -lc 'set -a && [ -f .env ] && source .env && set +a; DRY=1 node ../scripts/import-colegios-v2.mjs ../data/csv/import_contactos/colegios_importar.csv'",
    "import:colegios:v2:validate": "bash -lc 'set -a && [ -f .env ] && source .env && set +a; VALIDATE_ONLY=1 DRY=1 node ../scripts/import-colegios-v2.mjs ../data/csv/import_contactos/colegios_importar.csv'",
    "import:colegios:v2:prod": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; STRAPI_URL=https://strapi.moraleja.cl IMPORT_CONCURRENCY=${IMPORT_CONCURRENCY:-8} IMPORT_TOKEN=$TOKEN_PROD node ../scripts/import-colegios-v2.mjs ../data/csv/import_contactos/colegios_importar.csv'",
    "export:personas": "node -r dotenv/config ../scripts/export-personas.mjs",
    "export:personas:prod": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; STRAPI_URL=https://strapi.moraleja.cl IMPORT_TOKEN=$TOKEN_PROD node ../scripts/export-personas.mjs'",
    "export:colegios:v2": "node -r dotenv/config ../scripts/export-colegios-v2.mjs",
    "export:colegios:v2:prod": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; STRAPI_URL=https://strapi.moraleja.cl IMPORT_TOKEN=$TOKEN_PROD node ../scripts/export-colegios-v2.mjs'",
    "export:assignments:template": "node -r dotenv/config ../scripts/export-assignments-template.mjs",
    "export:assignments:template:prod": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; STRAPI_URL=https://strapi.moraleja.cl IMPORT_TOKEN=$TOKEN_PROD node ../scripts/export-assignments-template.mjs'",
    "import:colaboradores": "node -r dotenv/config ../scripts/import-colaboradores.mjs ../data/csv/import_contactos/colaboradores.csv",
    "import:colaboradores:prod": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; STRAPI_URL=https://strapi.moraleja.cl IMPORT_TOKEN=$TOKEN_PROD node ../scripts/import-colaboradores.mjs ../data/csv/import_contactos/colaboradores.csv'",
    "import:personas:simple": "node -r dotenv/config ../scripts/import-personas-simple.mjs ../data/csv/import_contactos/personas_colaboradores_emp.csv",
    "import:personas:simple:prod": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; STRAPI_URL=https://strapi.moraleja.cl IMPORT_TOKEN=$TOKEN_PROD node ../scripts/import-personas-simple.mjs ../data/csv/import_contactos/personas_colaboradores_emp.csv'",
    "import:promocion-contactos": "node -r dotenv/config ../scripts/import-promocion-contactos.mjs ../data/../data/imports/contactos_notion.csv",
    "import:promocion-contactos:dry": "bash -lc 'set -a && [ -f .env ] && source .env && set +a; DRY=1 node ../scripts/import-promocion-contactos.mjs ../data/../data/imports/contactos_notion.csv'",
    "import:promocion-contactos:prod": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; STRAPI_URL=https://strapi.moraleja.cl IMPORT_TOKEN=$TOKEN_PROD node ../scripts/import-promocion-contactos.mjs ../data/../data/imports/contactos_notion.csv'",
    "import:assignments:team": "node -r dotenv/config ../scripts/import-assignments-team.mjs ../data/csv/import_contactos/asignaciones_equipo.csv",
    "import:assignments:team:prod": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; STRAPI_URL=https://strapi.moraleja.cl IMPORT_TOKEN=$TOKEN_PROD node ../scripts/import-assignments-team.mjs ../data/csv/import_contactos/asignaciones_equipo.csv'",
    "import:assignments:team:batch": "bash -lc 'set -a && [ -f .env ] && source .env && set +a; bash ../scripts/import-assignments-batch.sh ../data/csv/import_respaldo/asignaciones_equipo.csv ${CHUNK_SIZE:-200}'",
    "import:assignments:team:batch:prod": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; STRAPI_URL=https://strapi.moraleja.cl IMPORT_TOKEN=$TOKEN_PROD bash ../scripts/import-assignments-batch.sh ../data/csv/import_respaldo/asignaciones_equipo.csv ${CHUNK_SIZE:-200}'",
    "import:personas:v2": "node -r dotenv/config ../scripts/import-personas-v2.mjs",
    "import:personas:v2:prod": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; STRAPI_URL=https://strapi.moraleja.cl IMPORT_TOKEN=$TOKEN_PROD node ../scripts/import-personas-v2.mjs ../data/csv/import_respaldo/personas_import_2025_09_29.csv'",
    "import:personas:v2:prod:dry": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; DRY=1 STRAPI_URL=https://strapi.moraleja.cl IMPORT_TOKEN=$TOKEN_PROD node ../scripts/import-personas-v2.mjs ../data/csv/import_respaldo/personas_import_2025_09_29.csv'",
    "import:attio:colegios": "node -r dotenv/config ../scripts/import-attio-companies.mjs",
    "sync:attio:colegios": "node -r dotenv/config ../scripts/sync-attio-colegios.mjs",
    "import:libros:prod": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; STRAPI_PROD_URL=https://strapi.moraleja.cl STRAPI_PROD_TOKEN=$TOKEN_PROD node ../scripts/import-libros-from-prod.mjs'",
    "import:libros:prod:dry": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; DRY=1 STRAPI_PROD_URL=https://strapi.moraleja.cl STRAPI_PROD_TOKEN=$TOKEN_PROD node ../scripts/import-libros-from-prod.mjs'",
    "gsheet:test": "node -r dotenv/config ../scripts/gsheet-test.mjs",
    "gsheet:libros:export": "node -r dotenv/config ../scripts/gsheet-libros-export.mjs",
    "gsheet:libros:import": "node -r dotenv/config ../scripts/gsheet-libros-import.mjs",
    "gsheet:libros:import:dry": "bash -lc 'set -a && [ -f .env ] && source .env && set +a; DRY=1 node ../scripts/gsheet-libros-import.mjs'",
    "gsheet:editoriales:export": "node -r dotenv/config ../scripts/gsheet-editoriales-export.mjs",
    "gsheet:editoriales:import": "node -r dotenv/config ../scripts/gsheet-editoriales-import.mjs",
    "gsheet:editoriales:import:dry": "bash -lc 'set -a && [ -f .env ] && source .env && set +a; DRY=1 node ../scripts/gsheet-editoriales-import.mjs'",
    "gsheet:autores:export": "node -r dotenv/config ../scripts/gsheet-autores-export.mjs",
    "gsheet:autores:import": "node -r dotenv/config ../scripts/gsheet-autores-import.mjs",
    "gsheet:autores:import:dry": "bash -lc 'set -a && [ -f .env ] && source .env && set +a; DRY=1 node ../scripts/gsheet-autores-import.mjs'",
    "gsheet:sellos:export": "node -r dotenv/config ../scripts/gsheet-sellos-export.mjs",
    "gsheet:sellos:import": "node -r dotenv/config ../scripts/gsheet-sellos-import.mjs",
    "gsheet:sellos:import:dry": "bash -lc 'set -a && [ -f .env ] && source .env && set +a; DRY=1 node ../scripts/gsheet-sellos-import.mjs'",
    "gsheet:colecciones:export": "node -r dotenv/config ../scripts/gsheet-colecciones-export.mjs",
    "gsheet:colecciones:import": "node -r dotenv/config ../scripts/gsheet-colecciones-import.mjs",
    "gsheet:colecciones:import:dry": "bash -lc 'set -a && [ -f .env ] && source .env && set +a; DRY=1 node ../scripts/gsheet-colecciones-import.mjs'",
    "gsheet:obras:export": "node -r dotenv/config ../scripts/gsheet-obras-export.mjs",
    "gsheet:obras:import": "node -r dotenv/config ../scripts/gsheet-obras-import.mjs",
    "gsheet:obras:import:dry": "bash -lc 'set -a && [ -f .env ] && source .env && set +a; DRY=1 node ../scripts/gsheet-obras-import.mjs'",
    "generar:id:colecciones": "node -r dotenv/config ../scripts/generar-id-colecciones.mjs",
    "generar:id:colecciones:dry": "bash -lc 'set -a && [ -f .env ] && source .env && set +a; DRY=1 node ../scripts/generar-id-colecciones.mjs'",
    "migrate:assignments:rol-orden": "node -r dotenv/config ../scripts/migrate-assignments-rol-orden.mjs",
    "migrate:assignments:rol-orden:prod": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; STRAPI_URL=https://strapi.moraleja.cl IMPORT_TOKEN=$TOKEN_PROD node ../scripts/migrate-assignments-rol-orden.mjs'",
    "migrate:colaboradores:rol-operativo": "node -r dotenv/config ../scripts/migrate-colaboradores-rol-operativo.mjs",
    "migrate:colaboradores:rol-operativo:prod": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; STRAPI_URL=https://strapi.moraleja.cl IMPORT_TOKEN=$TOKEN_PROD node ../scripts/migrate-colaboradores-rol-operativo.mjs'",
    "migrate:colegios:logo-to-component": "node -r dotenv/config ../scripts/migrate-colegio-logo-to-component.mjs",
    "migrate:colegios:logo-to-component:prod": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; STRAPI_URL=https://strapi.moraleja.cl IMPORT_TOKEN=$TOKEN_PROD node ../scripts/migrate-colegio-logo-to-component.mjs'",
    "docs:ct": "node -r dotenv/config ../scripts/generate-ct-docs.mjs",
    "docs:ct:prod": "node ../scripts/generate-ct-docs.mjs",
    "import:regiones": "node -r dotenv/config ../scripts/import-regiones.mjs ../data/region.csv",
    "import:provincias": "node -r dotenv/config ../scripts/import-provincias.mjs ../data/provincia.csv",
    "import:comunas": "node -r dotenv/config ../scripts/import-comunas.mjs ../data/comuna.csv",
    "import:zonas": "node -r dotenv/config ../scripts/import-zonas.mjs ../data/zona.csv",
    "import:all:dry": "bash -lc 'set -a && [ -f .env ] && source .env && set +a; DRY=1 node ../scripts/import-data.mjs'",
    "import:all": "bash -lc 'set -a && [ -f .env ] && source .env && set +a; node ../scripts/import-data.mjs'",
    "import:prod:dry": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; DRY=1 STRAPI_URL=https://strapi.moraleja.cl IMPORT_CONCURRENCY=${IMPORT_CONCURRENCY:-8} IMPORT_TOKEN=$TOKEN_PROD node ../scripts/import-data.mjs'",
    "import:prod": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; STRAPI_URL=https://strapi.moraleja.cl IMPORT_CONCURRENCY=${IMPORT_CONCURRENCY:-8} IMPORT_TOKEN=$TOKEN_PROD node ../scripts/import-data.mjs'",
    "check:provincias": "bash -lc 'set -a && [ -f .env ] && source .env && set +a; curl -sS -g -H \"Authorization: Bearer ${IMPORT_TOKEN:-$STRAPI_TOKEN}\" \"${STRAPI_URL:-http://localhost:1337}/api/provincias?populate[region][fields][0]=region_id&populate[region][fields][1]=region_nombre&populate[zona][fields][0]=zona_nombre&pagination[pageSize]=1\"'",
    "check:comunas": "bash -lc 'set -a && [ -f .env ] && source .env && set +a; curl -sS -g -H \"Authorization: Bearer ${IMPORT_TOKEN:-$STRAPI_TOKEN}\" \"${STRAPI_URL:-http://localhost:1337}/api/comunas?populate[provincia][fields][0]=provincia_id&populate[provincia][fields][1]=provincia_nombre&pagination[pageSize]=1\"'",
    "check:colegios": "bash -lc 'set -a && [ -f .env ] && source .env && set +a; curl -sS -g -H \"Authorization: Bearer ${IMPORT_TOKEN:-$STRAPI_TOKEN}\" \"${STRAPI_URL:-http://localhost:1337}/api/colegios?fields[0]=rbd&fields[1]=colegio_nombre&populate[comuna][fields][0]=comuna_id&populate[comuna][fields][1]=comuna_nombre&populate[provincia][fields][0]=provincia_id&populate[provincia][fields][1]=provincia_nombre&populate[region][fields][0]=region_id&populate[region][fields][1]=region_nombre&populate[zona][fields][0]=zona_nombre&pagination[pageSize]=1\"'",
    "check:prod:provincias": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; curl -sS -g -H \"Authorization: Bearer $TOKEN_PROD\" \"https://strapi.moraleja.cl/api/provincias?populate[region][fields][0]=region_id&populate[region][fields][1]=region_nombre&populate[zona][fields][0]=zona_nombre&pagination[pageSize]=1\"'",
    "check:prod:comunas": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; curl -sS -g -H \"Authorization: Bearer $TOKEN_PROD\" \"https://strapi.moraleja.cl/api/comunas?populate[provincia][fields][0]=provincia_id&populate[provincia][fields][1]=provincia_nombre&pagination[pageSize]=1\"'",
    "check:prod:colegios": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; curl -sS -g -H \"Authorization: Bearer $TOKEN_PROD\" \"https://strapi.moraleja.cl/api/colegios?fields[0]=rbd&fields[1]=colegio_nombre&populate[comuna][fields][0]=comuna_id&populate[comuna][fields][1]=comuna_nombre&populate[provincia][fields][0]=provincia_id&populate[provincia][fields][1]=provincia_nombre&populate[region][fields][0]=region_id&populate[region][fields][1]=region_nombre&populate[zona][fields][0]=zona_nombre&pagination[pageSize]=1\"'",
    "import:affiliations": "node -r dotenv/config ../scripts/import-affiliations.mjs ../data/csv/import_contactos/affiliations.csv",
    "import:affiliations:dry": "bash -lc 'set -a && [ -f .env ] && source .env && set +a; DRY=1 node ../scripts/import-affiliations.mjs ../data/csv/import_contactos/affiliations.csv'",
    "backup:prod": "bash -lc '[ -z \"$TOKEN_PROD\" ] && echo \"Falta TOKEN_PROD\" && exit 1; STRAPI_URL=https://strapi.moraleja.cl node ../scripts/backup-produccion-completo.mjs'",
    "backup:prod:transfer": "bash -lc '[ -z \"$TRANSFER_TOKEN\" ] || [ -z \"$TRANSFER_SECRET\" ] && echo \"Falta TRANSFER_TOKEN y TRANSFER_SECRET\" && exit 1; npx strapi transfer --from https://strapi.moraleja.cl --from-token=$TRANSFER_TOKEN --from-secret=$TRANSFER_SECRET --to ../backups/transfer-$(date +%Y%m%d-%H%M%S).tar.gz'",
    "woo:config": "node ../scripts/configurar-woocommerce.mjs",
    "woo:test:moraleja": "node ../scripts/configurar-woocommerce.mjs --test moraleja",
    "woo:test:escolar": "node ../scripts/configurar-woocommerce.mjs --test escolar",
    "woo:instructions": "node ../scripts/configurar-woocommerce.mjs --instructions",
    "woo:verify": "node ../scripts/verificar-mapeo-woo.mjs",
    "woo:verify:all": "node ../scripts/verificar-mapeo-woo.mjs --all",
    "import:backup": "node ../scripts/importar-backup-local.mjs",
    "import:backup:latest": "node ../scripts/importar-backup-local.mjs ../backups/backup-2025-11-17T23-20-11",
    "transfer:prod-to-local": "bash -lc '[ -z \"$TRANSFER_TOKEN\" ] || [ -z \"$TRANSFER_SECRET\" ] || [ -z \"$TRANSFER_TOKEN_LOCAL\" ] || [ -z \"$TRANSFER_SECRET_LOCAL\" ] && echo \"Faltan tokens de transfer. Configura TRANSFER_TOKEN, TRANSFER_SECRET, TRANSFER_TOKEN_LOCAL y TRANSFER_SECRET_LOCAL\" && exit 1; npx strapi transfer --from https://strapi.moraleja.cl --from-token=$TRANSFER_TOKEN --from-secret=$TRANSFER_SECRET --to http://localhost:1337 --to-token=$TRANSFER_TOKEN_LOCAL --to-secret=$TRANSFER_SECRET_LOCAL'"
  },
  "dependencies": {
    "@strapi/data-transfer": "^5.29.0",
    "@strapi/plugin-cloud": "5.29.0",
    "@strapi/plugin-users-permissions": "5.29.0",
    "@strapi/provider-email-nodemailer": "^5.29.0",
    "@strapi/provider-email-sendgrid": "^5.33.3",
    "@strapi/provider-upload-aws-s3": "^5.29.0",
    "@strapi/strapi": "5.29.0",
    "@strapi/utils": "5.29.0",
    "@types/bcryptjs": "^2.4.6",
    "axios": "^1.13.2",
    "bcryptjs": "^3.0.3",
    "better-sqlite3": "11.3.0",
    "csv-parse": "^6.1.0",
    "dotenv": "^17.2.2",
    "fs-extra": "^10.0.0",
    "googleapis": "^166.0.0",
    "mime-types": "^2.1.27",
    "node-fetch": "^3.3.2",
    "p-limit": "^7.1.1",
    "pg": "^8.16.3",
    "react": "^18.0.0",
    "react-dom": "^18.0.0",
    "react-router-dom": "^6.0.0",
    "styled-components": "^6.0.0"
  },
  "devDependencies": {
    "@types/koa": "^2.15.0",
    "@types/node": "^20",
    "@types/react": "^18",
    "@types/react-dom": "^18",
    "glob": "^11.0.3",
    "typescript": "^5",
    "vitest": "^4.0.16"
  },
  "engines": {
    "node": ">=18.0.0 <=22.x.x",
    "npm": ">=6.0.0"
  },
  "strapi": {
    "uuid": "fde1c6bf-bf41-4af0-aea9-f422894693af",
    "installId": "a6ce32bc69801251382bda51e7675e22d8fc30061db038b5db301e33bd24bb61"
  },
  "packageManager": "pnpm@10.18.3+sha512.bbd16e6d7286fd7e01f6b3c0b3c932cda2965c06a908328f74663f10a9aea51f1129eea615134bf992831b009eabe167ecb7008b597f40ff9bc75946aadfb08d"
}
